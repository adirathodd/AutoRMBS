<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>AutoRMBS - PDF to Excel Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Google Font: Montserrat -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900&display=swap" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
  <!-- Custom Styles -->
  <style>
    /* Reset and Base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Montserrat', sans-serif;
      background: #f7f9fc;
      color: #333;
      line-height: 1.6;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    
    /* Hero Section */
    .hero {
      background: url('images/hero-bg.jpg') center/cover no-repeat;
      padding: 4rem 1rem;
      text-align: center;
      color: #000000;
    }
    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }
    .hero p {
      font-size: 1.2rem;
      margin-bottom: 2rem;
    }
    .hero a {
      background-color: #002855;
      color: #fff;
      padding: 0.75rem 1.5rem;
      border-radius: 5px;
      font-weight: 500;
      transition: background-color 0.3s;
    }
    .hero a:hover {
      background-color: #0054a6;
    }

    /* Container */
    .container {
      max-width: 900px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    /* Card Styles */
    .card {
      background-color: #fff;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 2rem;
    }
    .card h2 {
      font-size: 1.75rem;
      color: #002855;
      margin-bottom: 1rem;
      border-bottom: 2px solid #002855;
      padding-bottom: 0.5rem;
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    input[type="file"] {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .button {
      background-color: #002855;
      color: #fff;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 5px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .button:hover {
      background-color: #0054a6;
    }
    #extracted_text {
      width: 100%;
      min-height: 150px;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 5px;
      margin-top: 1rem;
      font-size: 0.95rem;
      resize: vertical;
    }
    .hidden {
      display: none;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 1rem;
      font-size: 0.9rem;
      color: #777;
    }
  </style>
</head>
<body>
  <!-- Navigation Bar (Inspired by Webflow) -->
  <div class="navigation" role="banner">
    <div class="navigation-wrap">
      <a href="index.html" aria-current="page" class="logo-link">
        <div class="text-block">AutoRMBS</div>
      </a>
      <div class="menu">
        <nav role="navigation">
          <a href="about.html" class="navigation-item">About</a>
          <a href="inputs.html" class="navigation-item">Work</a>
          <a href="contact.html" class="navigation-item">Contact</a>
        </nav>
      </div>
      <a href="login.html" class="primary-button">
        <div>LOGÂ IN</div>
      </a>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero">
    <h1>AutoRMBS - PDF to Excel Demo</h1>
    <p>
      Upload your PDF containing mortgage information. Our advanced AI extracts key data and generates an Excel report in seconds.
    </p>
    <a href="#upload-section">Get Started</a>
  </section>

  <!-- Main Content -->
  <div class="container" id="upload-section">
    <!-- Card for Uploading PDF -->
    <div class="card">
      <h2>1. Upload PDF</h2>
      <form id="pdf-form" enctype="multipart/form-data">
        <div class="form-group">
          <label for="pdf-upload">Choose PDF File</label>
          <input type="file" name="pdf-upload" id="pdf-upload" accept="application/pdf" required>
        </div>
        <button type="submit" class="button">Upload and Process</button>
      </form>
    </div>

    <!-- Card for Extracted JSON Data -->
    <div class="card">
      <h2>2. Extracted Data (JSON)</h2>
      <textarea id="extracted_text" readonly></textarea>
      <button id="downloadExcelBtn" class="button hidden">Download Excel</button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    &copy; 2025 AutoRMBS. All rights reserved.
  </footer>

  <!-- jQuery Script -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#pdf-form').on('submit', function (e) {
        e.preventDefault();

        const fileInput = $('#pdf-upload')[0];
        if (!fileInput.files.length) {
          alert("Please choose a PDF file first.");
          return;
        }

        const formData = new FormData();
        formData.append('pdf-upload', fileInput.files[0]);

        // Send PDF to the server
        $.ajax({
          url: '/upload',
          type: 'POST',
          data: formData,
          processData: false,
          contentType: false,
          success: function(response) {
            // Display the JSON in the textarea
            $('#extracted_text').val(JSON.stringify(response, null, 2));

            // Show Download Excel button if available
            if (response.excelDownload) {
              $('#downloadExcelBtn').removeClass('hidden');
              $('#downloadExcelBtn').off('click').on('click', function() {
                window.location.href = response.excelDownload;
              });
            }
          },
          error: function(xhr, status, error) {
            alert("Error uploading or processing PDF: " + error);
            console.error("Error details:", xhr.responseText);
          }
        });
      });
    });
  </script>
</body>
</html>